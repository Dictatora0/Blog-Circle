#!/bin/bash

###############################################################
# 虚拟机服务重启脚本
# 重启虚拟机上的所有服务
###############################################################

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
NC='\033[0m'

echo "========================================="
echo "   重启虚拟机服务"
echo "========================================="
echo ""

# 1. 停止服务
echo "=== 1. 停止所有服务 ==="
bash "$SCRIPT_DIR/stop-vm-services.sh"
echo ""

# 2. 等待清理完成
echo "=== 2. 等待清理完成 ==="
sleep 5
echo -e "${GREEN}✓ 等待完成${NC}"
echo ""

# 3. 启动服务
echo "=== 3. 启动所有服务 ==="
bash "$SCRIPT_DIR/start-vm-services.sh"
echo ""

echo "========================================="
echo -e "${GREEN}   虚拟机服务重启完成${NC}"
echo "========================================="
