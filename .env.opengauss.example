# OpenGauss Docker Compose 环境配置模板
# 复制此文件为 .env.opengauss 并根据实际环境修改

# ============================================
# 数据库配置
# ============================================
# OpenGauss 主库密码（必须包含大小写字母、数字、特殊字符）
OPENGAUSS_PASSWORD=Blog@2025

# 主库节点名称
OPENGAUSS_PRIMARY_NODENAME=gaussdb_primary

# 备库1节点名称和端口
OPENGAUSS_STANDBY1_NODENAME=gaussdb_standby1
OPENGAUSS_STANDBY1_PORT=15432

# 备库2节点名称和端口
OPENGAUSS_STANDBY2_NODENAME=gaussdb_standby2
OPENGAUSS_STANDBY2_PORT=25432

# ============================================
# 数据库镜像配置
# ============================================
# OpenGauss 镜像（支持多个版本）
# 推荐使用具体版本号而不是 latest
OPENGAUSS_IMAGE=enmotech/opengauss-lite:5.0.0
# 备选镜像：
# OPENGAUSS_IMAGE=enmotech/opengauss:5.0.0
# OPENGAUSS_IMAGE=openeuler/opengauss:5.0.0

# ============================================
# 应用镜像配置
# ============================================
# 后端镜像标签
BACKEND_IMAGE_TAG=vm

# 前端镜像标签
FRONTEND_IMAGE_TAG=vm

# ============================================
# 网络配置
# ============================================
# Docker 网络子网（确保不与宿主机网络冲突）
DOCKER_NETWORK_SUBNET=172.26.0.0/16

# 主库 IP
OPENGAUSS_PRIMARY_IP=172.26.0.10

# 备库1 IP
OPENGAUSS_STANDBY1_IP=172.26.0.11

# 备库2 IP
OPENGAUSS_STANDBY2_IP=172.26.0.12

# ============================================
# 端口映射配置
# ============================================
# 主库端口映射（宿主机:容器）
OPENGAUSS_PRIMARY_PORT=5432

# 备库1 端口映射
OPENGAUSS_STANDBY1_MAPPED_PORT=5434

# 备库2 端口映射
OPENGAUSS_STANDBY2_MAPPED_PORT=5436

# ============================================
# 应用服务配置
# ============================================
# 后端数据库连接
SPRING_DATASOURCE_URL=jdbc:opengauss://opengauss-primary:5432/blog_db
SPRING_DATASOURCE_USERNAME=bloguser
SPRING_DATASOURCE_PASSWORD=Blog@2025
SPRING_DATASOURCE_DRIVER_CLASS_NAME=org.opengauss.Driver

# 后端服务端口
BACKEND_PORT=8080
BACKEND_MAPPED_PORT=8082

# 前端服务端口
FRONTEND_PORT=8080
FRONTEND_MAPPED_PORT=8080

# 后端 Java 内存配置
JAVA_XMS=64m
JAVA_XMX=128m

# ============================================
# 前端配置
# ============================================
# 后端 API 地址（容器内访问）
BACKEND_URL=http://backend:8080

# ============================================
# 容器配置
# ============================================
# 容器重启策略
RESTART_POLICY=unless-stopped

# 健康检查间隔（秒）
HEALTHCHECK_INTERVAL=10

# 健康检查超时（秒）
HEALTHCHECK_TIMEOUT=5

# 健康检查重试次数
HEALTHCHECK_RETRIES=5

# ============================================
# 卷配置
# ============================================
# 数据卷驱动
VOLUME_DRIVER=local

# 是否保留数据卷（true: 保留，false: 删除）
PRESERVE_VOLUMES=true

# ============================================
# 日志配置
# ============================================
# 日志级别
LOG_LEVEL=INFO

# ============================================
# 调试配置
# ============================================
# 是否启用 privileged 模式
PRIVILEGED_MODE=true

# 是否启用 SYS_PTRACE 和 SYS_ADMIN capabilities
ENABLE_PTRACE=true
